<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>set and map</title>
    <link href="../css/es6.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript">

        /**
         * map
         * map类似对象,是键值对的集合,但是'键'的范围不限于字符串.各种类型的值(包括对象)都可以当做键
         * 也就是说,Object结构提供了'字符串---值'的对应,Map结构提供了'值---值'的对应,是一种更完善的Hash
         * 结构实现，如果你需要'键值对'的数据结构,Map比Object更合适
         *
         * 任何具有Iterator接口,且每个成员都是一个双元素的数组的数结构都可以当做Map
         * 构造函数的参数,也就是说,set和map都可以用来生成新的map
         * 如果对同一个键连续赋值两次,后一次的值会覆盖前一次的值
         * 如果读取一个未知的键,则返回undefined
         *
         * map的键实际上是跟内存地址绑定的,只要内存地址不一样,就视为两个不同的键
         * 如果map是一个简单类型的值(数字,字符串,布尔值),则只要两个值严格相等,Map将其
         * 视为一个键,比如0和-0就是一个键，布尔值true和字符串true则是两个不同的键，另外,
         * undefined和null也是两个不同的键,
         * 虽然NaN不严格相等于自身,其视为同一个键
         *
         * 遍历方法
         * Map结构原生提供三个遍历器生成函数和一个遍历方法
         * -keys():返回键名的遍历器
         * -values():返回键值的遍历器
         * -entries():返回所有成员的遍历器
         * -forEach():遍历Map的所有成员
         *
         * map的遍历顺序就是插入顺序
         *
         * map结构转为数组结构,比较快速的方法是使用拓展运算符(...)
         *
         * map与其他数据结构的互相转换
         * 1) map转为数组
         * map转为数组最方便的方法，就是使用拓展运算符(...)
         *
         * 2)数组转为map
         * 将数组传入map构造函数,就可以转为map
         *
         * 3)map转为对象
         * 如果所有的map的键都是字符串，他可以无损的转为对象
         * 如果有非字符串的键名，那么这个键名会被转为字符串，再作为对象的键名
         *
         * 4)对象转为map
         *
         * 5)map转json
         * map转json要区分两种情况
         * 一种情况是,Map的键名都是字符串,这时可以选择转为对象Json
         * 另外一种情况是map的键名有非字符串，这时可以选择转为数组json
         *
         * 6)json转map
         * json转为map，正常情况下,所有键名都是字符串
         *
         *
         *  WeakMap
         *  WeakMap只接收对象作为键名(null除外),不接受其他类型的值作为键名
         *  WeakMap的键名所指向的对象，不计入垃圾回收机制
         *
         *  WeakMap的键名所引用的对象都是弱引用,即垃圾回收机制不将该引用考虑在内
         *  在网页的Dom元素上添加数据就可以使用WeakMap结构，当该dom元素被清除，
         *  其所对应的WeakMap记录就会自动被移除
         *  WeakMap弱引用的只是键名，而不是键值，键值依然是正常引用
         *
         *  WeakMap没有遍历操作(即没有keys(),values(),entries()),也没有size属性
         *  也无法清空，也就是没有clear方法,因此weakMap只有四个方法可用:get(),set()
         */
        //map转对象
        function strMapToObj(map){
            let obj=Object.create(null);
            for(let [k,v] of map){
                obj[k]=v;
            }
            return obj;
        }

        //对象转map
        function objToMap(obj){
            let map=new Map();
            for(let k of Object.keys(obj)){
                map.set(k,obj[k]);
            }
            return map;
        }

        //map转json map键名都是字符串
        function mapToJson(map){
            return JSON.stringify(strMapToObj(map))
        }

        //map转json map键名含有非字符串,这时可以选择转为数组json-+
        function mapToArrayJson(map){
            return JSON.stringify([...map]);
        }

        //json转map,正常情况
        function jsonToMap(jsonStr){
            return objToMap(JSON.parse(jsonStr));
        }


    </script>
</head>
<body>

</body>
</html>











